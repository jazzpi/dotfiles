#!/bin/bash

if ! ( [ -d .git ] || git rev-parse --git-dir >/dev/null ); then
    exit 128
fi

CONFIG_DIR="${XDG_STATE_HOME:-$HOME/.local/state}/git"
mkdir -p "$CONFIG_DIR"

if [ $# -ne 3 ]; then
    >&2 echo "Usage: $(basename $0) CONFIG-NAME EMAIL USERNAME"
    exit 64
fi

output_path="$CONFIG_DIR/$1"

cat <<EOF > "$output_path"
#!/bin/bash

## AUTO-GENERATED BY $0

git config user.email "$2"
git config user.name "$3"
EOF
chmod +x "$output_path"
